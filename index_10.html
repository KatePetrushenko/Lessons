<html>

<head>
    <title>JAVASCRIPT</title>
</head>

<body>
    <script>
        // ЗАДАНИЯ ДЛЯ РАЗМИНКИ!!!!!!)))

        //1) Есть промис! что за параметры принимает функция? Зачем они? как вернуть обьект {id: 10, name: 'Sergei'} и 
        // потом принять его с помощью функции промиса then? Как вернуть ошибку в промисе и потом ее перехватить?

        // Promise используются для удобной организации ассинхронного кода
        const pr = new Promise(function (resolve, reject) { //результат resolve при успешном выполнении и reject при ошибке
	        setTimeout(function() {
			    resolve({id: 10, name: 'Sergei'}); //наш обьект
            }, 300);
            reject(new Error("My Custom Error!!!"));
        })
        pr.then(data => data).catch(console.log('ERROR!!!'));

        //2) Есть код ! с помощью промисов написать таким образом чтобы выполнилось по порядку от одного до 5!
        // На данный момент выполнятся setTimeout-ы вконце!!
        
        let newPr1 = new Promise(function(resolve, reject) {
            setTimeout(() => {
            	resolve('1');
            }, 1300);
        });
        let newPr2 = new Promise(function(resolve, reject) {
            resolve('2');
        });
        let newPr3 = new Promise(function(resolve, reject) {
            resolve('3');
        });
        let newPr4 = new Promise(function(resolve, reject) {
            setTimeout(()=> resolve('4'), 300);
        });
        let newPr5 = new Promise(function(resolve, reject) {
            resolve('5');
        });

        newPr1.then((e) => {
            console.log(e);
            return newPr2;
        }).then((a) => {
            console.log(a);
            return newPr3;
        }).then((b) => {
            console.log(b);
            return newPr4;
        }).then((c) => {
            console.log(c);
            return newPr5;
        }).then((d) => {
            console.log(d);
        })

        //3) Есть код !  Нужно всего лишь написать комментарий что делает каждая из строчок!
        const pr2 = new Promise(function (resolve, reject) {
            resolve({id: 2}) // resolve (успешное выполнение) принимает обьект {id: 2}
        });
        pr2.then((data) => data) // принимает обьект {id: 2}
            .then((res) => { 
                throw new Error('Something went wrong') 
            })
            .catch((e) => console.log('ERROR', e) )
       
        // 4) Использую Promise.all получить массив из промисов и после чего отсортировать тот что возвращает массив! 
        const prom1 = new Promise(function (resolve, reject) {
            resolve(10);
        }) 
        const prom2 = new Promise(function (resolve, reject) {
            resolve({id: 3});
        }) 
        const prom3 = new Promise(function (resolve, reject) {
            resolve([6, 2, 4, 6]);
        }) 
        // 5) Есть роуты!!
        // https://playwithpromise.herokuapp.com/api/order-review/last - вернет обьект с id такой( 5d4762e02481a600174fb1ae )
        // после чего используя id делаем другой запрос
        // https://playwithpromise.herokuapp.com/api/order-review/getid/{id} 
        // ответ будет обьект у которого будет поле orderList - массив с двух обьектов 
        // у обьектов будет productId еще сделать запрос по productId то есть два запроса ибо 2 обьекта в которых свой productId Promise.all в помощь!!
        // ВОТ ПРИМЕР ЗАПРОСА по первому URL! Конечно это нужно будет обернуть в промис!
        var Req = new XMLHttpRequest();
        Req.onload = function () {
            if (!this.responseText) rej('BYE');
            // res(JSON.parse(this.responseText));
        }
        Req.open("GET", 'https://playwithpromise.herokuapp.com/api/order-review/last');
        Req.send();
        
    </script>
</body>

</html>